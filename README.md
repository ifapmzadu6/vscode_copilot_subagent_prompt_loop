# Subagent Prompt Optimizer

VS Code拡張機能 - 複数のサブエージェントを使用して最適なプロンプトを見つけるツール

## 機能

このツールは以下の特徴を持ちます：

1. **LanguageModelTool**: `optimize_prompt_with_subagents` という名前のツールを提供
2. **並列サブエージェント実行**: 5つのサブエージェントを同時に並行して呼び出し
3. **プロンプト最適化ループ**: 結果を分析し、プロンプトを改善しながら繰り返し実行

## 動作の流れ

```
ユーザータスク入力
    ↓
┌─────────────────────────────────────────┐
│ Loop (iterations回繰り返し)              │
│                                          │
│  ┌───────────────────────────────────┐  │
│  │ 5つのSubagentを並列実行           │  │
│  │                                   │  │
│  │  Subagent 1: Direct approach      │  │
│  │  Subagent 2: Step-by-Step         │  │
│  │  Subagent 3: Expert Role          │  │
│  │  Subagent 4: Structured Output    │  │
│  │  Subagent 5: Critical Thinking    │  │
│  └───────────────────────────────────┘  │
│                  ↓                       │
│  ┌───────────────────────────────────┐  │
│  │ 分析Subagent                      │  │
│  │                                   │  │
│  │  - どの結果が最も良かったか       │  │
│  │  - プロンプトが良かったのか運か   │  │
│  │  - なぜ良かったのか分析           │  │
│  │  - 改善点の抽出                   │  │
│  └───────────────────────────────────┘  │
│                  ↓                       │
│  ┌───────────────────────────────────┐  │
│  │ プロンプト改善                    │  │
│  │                                   │  │
│  │  分析結果を基に次のイテレーション │  │
│  │  のプロンプトを最適化             │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
    ↓
最終レポート生成
- 各イテレーションの結果
- 最も効果的なプロンプトアプローチ
- 学んだ改善点
- 最終的な最良の結果
```

## 使い方

### インストール

```bash
cd /path/to/this/extension
npm install
npm run compile
```

### VS Codeで使用

1. F5を押して拡張機能開発ホストを起動
2. Copilot Chatで `#promptOptimizer` を使用するか、エージェントモードでツールが自動的に呼び出される

### パラメータ

| パラメータ | 必須 | 説明 |
|-----------|------|------|
| `task` | Yes | サブエージェントに委譲するメインタスク |
| `iterations` | No | 最適化ループの回数（デフォルト: 3） |
| `context` | No | サブエージェントに提供する追加コンテキスト |

### 使用例

```
#promptOptimizer How can I optimize this Python function for better performance?
```

## 5つのプロンプトアプローチ

1. **Direct**: 直接的で簡潔なアプローチ
2. **Step-by-Step**: 段階的に問題を分解するアプローチ
3. **Expert Role**: 専門家として振る舞うアプローチ
4. **Structured Output**: 構造化された出力を要求するアプローチ
5. **Critical Thinking**: 複数のアプローチを検討し、最善を選ぶアプローチ

## 分析の観点

分析サブエージェントは以下を評価します：

- **最良の結果の特定**: どのサブエージェントが最も良い結果を出したか
- **成功要因の分析**: プロンプトが良かったのか、単に運が良かったのかの判断
- **改善点の抽出**: 良かった点を特定し、次のイテレーションに反映
- **推奨事項**: より良いプロンプトのための具体的な提案

## 開発

```bash
# 依存関係のインストール
npm install

# コンパイル
npm run compile

# 監視モード
npm run watch

# Lint
npm run lint
```

## 要件

- VS Code 1.100.0以上
- GitHub Copilot Chat拡張機能（`runSubagent`ツールを使用するため）

## ライセンス

MIT
